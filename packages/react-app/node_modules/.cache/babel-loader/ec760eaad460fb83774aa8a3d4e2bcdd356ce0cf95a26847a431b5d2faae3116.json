{"ast":null,"code":"import { useConfig } from './useConfig';\nimport { useEthers } from './useEthers';\nimport { estimateTransactionGasLimit, usePromiseTransaction } from './usePromiseTransaction';\nimport { useReadonlyNetworks } from '../providers/network/readonlyNetworks/context';\nimport { getSignerFromOptions } from '../helpers/getSignerFromOptions';\n/**\n * Hook returns an object with three variables: `state`, `resetState`, and `sendTransaction`.\n *\n * ``state` represents the status of transaction. See {@link TransactionStatus}.\n *\n * `resetState` can be used to reset the state to `None` after a transaction attempt has either succeeded or failed.\n *\n * To send a transaction use `sendTransaction` function returned by `useSendTransaction`.\n *\n * Function accepts a [Transaction Request](https://docs.ethers.io/v5/api/providers/types/#providers-TransactionRequest) object as a parameter.\n * @public\n * @param options additional options of type {@link TransactionOptions}\n * @returns {} object with two variables: `sendTransaction` and `state`: `{ sendTransaction: (...args: any[]) => void, state: TransactionStatus }`.\n *\n * @example\n * const { sendTransaction, state } = useSendTransaction({ transactionName: 'Send Ethereum' })\n *\n * const handleClick = () => {\n *   ...\n *   sendTransaction({ to: address, value: utils.parseEther(amount) })\n * }\n */\nexport function useSendTransaction(options) {\n  var _a, _b, _c;\n  const {\n    library,\n    chainId\n  } = useEthers();\n  const transactionChainId = options && 'chainId' in options && (options === null || options === void 0 ? void 0 : options.chainId) || chainId;\n  const {\n    promiseTransaction,\n    state,\n    resetState\n  } = usePromiseTransaction(transactionChainId, options);\n  const config = useConfig();\n  const gasLimitBufferPercentage = (_c = (_b = (_a = options === null || options === void 0 ? void 0 : options.gasLimitBufferPercentage) !== null && _a !== void 0 ? _a : options === null || options === void 0 ? void 0 : options.bufferGasLimitPercentage) !== null && _b !== void 0 ? _b : config === null || config === void 0 ? void 0 : config.gasLimitBufferPercentage) !== null && _c !== void 0 ? _c : 0;\n  const providers = useReadonlyNetworks();\n  const provider = transactionChainId && providers[transactionChainId];\n  const sendTransaction = async transactionRequest => {\n    var _a;\n    const signer = getSignerFromOptions(provider, options, library);\n    if (signer) {\n      const gasLimit = await estimateTransactionGasLimit(transactionRequest, signer, gasLimitBufferPercentage);\n      return promiseTransaction(signer.sendTransaction(Object.assign(Object.assign({}, transactionRequest), {\n        gasLimit\n      })), {\n        safeTransaction: {\n          to: transactionRequest.to,\n          value: (_a = transactionRequest.value) === null || _a === void 0 ? void 0 : _a.toString()\n        }\n      });\n    }\n  };\n  return {\n    sendTransaction,\n    state,\n    resetState\n  };\n}","map":{"version":3,"mappings":"AAEA,SAASA,SAAS,QAAQ,aAAa;AACvC,SAASC,SAAS,QAAQ,aAAa;AACvC,SAASC,2BAA2B,EAAEC,qBAAqB,QAAQ,yBAAyB;AAC5F,SAASC,mBAAmB,QAAQ,+CAA+C;AAEnF,SAASC,oBAAoB,QAAQ,iCAAiC;AAGtE;;;;;;;;;;;;;;;;;;;;;;AAsBA,OAAM,SAAUC,kBAAkB,CAACC,OAA4B;;EAC7D,MAAM;IAAEC,OAAO;IAAEC;EAAO,CAAE,GAAGR,SAAS,EAAE;EACxC,MAAMS,kBAAkB,GAAIH,OAAO,IAAI,SAAS,IAAIA,OAAO,KAAIA,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEE,OAAO,KAAKA,OAAO;EAC3F,MAAM;IAAEE,kBAAkB;IAAEC,KAAK;IAAEC;EAAU,CAAE,GAAGV,qBAAqB,CAACO,kBAAkB,EAAEH,OAAO,CAAC;EAEpG,MAAMO,MAAM,GAAGd,SAAS,EAAE;EAC1B,MAAMe,wBAAwB,GAC5B,yBAAO,aAAPR,OAAO,uBAAPA,OAAO,CAAEQ,wBAAwB,mCAAIR,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAES,wBAAwB,mCAAIF,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEC,wBAAwB,mCAAI,CAAC;EAEjH,MAAME,SAAS,GAAGb,mBAAmB,EAAE;EACvC,MAAMc,QAAQ,GAAIR,kBAAkB,IAAIO,SAAS,CAACP,kBAA6B,CAAG;EAElF,MAAMS,eAAe,GAAG,MAAOC,kBAAsC,IAAI;;IACvE,MAAMC,MAAM,GAAGhB,oBAAoB,CAACa,QAAkC,EAAEX,OAAO,EAAEC,OAAO,CAAC;IAEzF,IAAIa,MAAM,EAAE;MACV,MAAMC,QAAQ,GAAG,MAAMpB,2BAA2B,CAACkB,kBAAkB,EAAEC,MAAM,EAAEN,wBAAwB,CAAC;MAExG,OAAOJ,kBAAkB,CACvBU,MAAM,CAACF,eAAe,iCACjBC,kBAAkB;QACrBE;MAAQ,GACR,EACF;QACEC,eAAe,EAAE;UACfC,EAAE,EAAEJ,kBAAkB,CAACI,EAAE;UACzBC,KAAK,EAAE,wBAAkB,CAACA,KAAK,0CAAEC,QAAQ;;OAE5C,CACF;;EAEL,CAAC;EAED,OAAO;IAAEP,eAAe;IAAEP,KAAK;IAAEC;EAAU,CAAE;AAC/C","names":["useConfig","useEthers","estimateTransactionGasLimit","usePromiseTransaction","useReadonlyNetworks","getSignerFromOptions","useSendTransaction","options","library","chainId","transactionChainId","promiseTransaction","state","resetState","config","gasLimitBufferPercentage","bufferGasLimitPercentage","providers","provider","sendTransaction","transactionRequest","signer","gasLimit","safeTransaction","to","value","toString"],"sources":["/Users/jaleltounsi/Documents/GitHub/apexwave.fi/apexwave/node_modules/@usedapp/core/src/hooks/useSendTransaction.ts"],"sourcesContent":["import type { TransactionRequest } from '@ethersproject/abstract-provider'\nimport { TransactionOptions } from '../model/TransactionOptions'\nimport { useConfig } from './useConfig'\nimport { useEthers } from './useEthers'\nimport { estimateTransactionGasLimit, usePromiseTransaction } from './usePromiseTransaction'\nimport { useReadonlyNetworks } from '../providers/network/readonlyNetworks/context'\nimport { ChainId } from '../constants'\nimport { getSignerFromOptions } from '../helpers/getSignerFromOptions'\nimport { providers } from 'ethers'\n\n/**\n * Hook returns an object with three variables: `state`, `resetState`, and `sendTransaction`.\n *\n * ``state` represents the status of transaction. See {@link TransactionStatus}.\n *\n * `resetState` can be used to reset the state to `None` after a transaction attempt has either succeeded or failed.\n *\n * To send a transaction use `sendTransaction` function returned by `useSendTransaction`.\n *\n * Function accepts a [Transaction Request](https://docs.ethers.io/v5/api/providers/types/#providers-TransactionRequest) object as a parameter.\n * @public\n * @param options additional options of type {@link TransactionOptions}\n * @returns {} object with two variables: `sendTransaction` and `state`: `{ sendTransaction: (...args: any[]) => void, state: TransactionStatus }`.\n *\n * @example\n * const { sendTransaction, state } = useSendTransaction({ transactionName: 'Send Ethereum' })\n *\n * const handleClick = () => {\n *   ...\n *   sendTransaction({ to: address, value: utils.parseEther(amount) })\n * }\n */\nexport function useSendTransaction(options?: TransactionOptions) {\n  const { library, chainId } = useEthers()\n  const transactionChainId = (options && 'chainId' in options && options?.chainId) || chainId\n  const { promiseTransaction, state, resetState } = usePromiseTransaction(transactionChainId, options)\n\n  const config = useConfig()\n  const gasLimitBufferPercentage =\n    options?.gasLimitBufferPercentage ?? options?.bufferGasLimitPercentage ?? config?.gasLimitBufferPercentage ?? 0\n\n  const providers = useReadonlyNetworks()\n  const provider = (transactionChainId && providers[transactionChainId as ChainId])!\n\n  const sendTransaction = async (transactionRequest: TransactionRequest) => {\n    const signer = getSignerFromOptions(provider as providers.BaseProvider, options, library)\n\n    if (signer) {\n      const gasLimit = await estimateTransactionGasLimit(transactionRequest, signer, gasLimitBufferPercentage)\n\n      return promiseTransaction(\n        signer.sendTransaction({\n          ...transactionRequest,\n          gasLimit,\n        }),\n        {\n          safeTransaction: {\n            to: transactionRequest.to,\n            value: transactionRequest.value?.toString(),\n          },\n        }\n      )\n    }\n  }\n\n  return { sendTransaction, state, resetState }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}